<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Calcium Test</title>
	<link rel="stylesheet" href="Ca.css">
	<link rel="stylesheet" href="test.css">
</head>
<body>
	<ul class="ca-container">

		<!-- Home -->
		<li class="ca-page" data-ca-route="/">
			<span data-ca-bind="textContent: data.greeting"></span>

				<p>Hello, <span data-ca-bind="textContent: data.user.username"></span>!</p>
				Not you? <button data-ca-bind="click: methods.logout">Log Out</button>
			</div>

			<div data-ca-if="!data.loggedIn">
				<p>Hey there! You aren't logged in. Why not <a href="/login" data-ca-link>log in?</a></p>
			</div>
		</li>

		<!-- Login -->
		<li class="ca-page" data-ca-route="/login">
			<span>Please log in</span>

			<form class="login-form" data-ca-bind="submit: methods.login">
				<label for="login-name">Username</label>
				<input type="text" id="login-name">

				<input type="submit" value="Log In">
			</form>

			<a href="/" data-ca-link>Back to home</a>

		</li>

		<!-- 404 -->
		<li class="ca-page" data-ca-route="*">
			<span>Page not found!</span>
			<a href="/" data-ca-link>Return to home!</a>
		</li>

	</ul>

	<script src="Ca.js"></script>

	<script>
		Ca.models.data = {
			greeting: 'Hello! this is from the "data" model.',
			loggedIn: false,
			user: null,
		}

		Ca.models.methods = {
			login: function() {
				var data = Ca.models.data;

				var username = document.getElementById('login-name').value;

				console.log('logging in as '+username);

				data.loggedIn = true;
				data.user = {
					username: username,
					favoriteFoods: []
				};

				Ca.router.go('/');
			},

			logout: function() {
				var data = Ca.models.data;

				document.getElementById('login-name').value = '';
				data.loggedIn = false;
				data.user = null;
			},
		}

		console.log(window.Ca);
	</script>
</body>
</html>
